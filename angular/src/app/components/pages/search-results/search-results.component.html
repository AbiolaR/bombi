<div id="search-header">
    <div id="search-bar" class="search-bar">
        <app-search [searchString]="searchString" [selectedLang]="selectedLang"></app-search>
        <button mat-fab (click)="openProfileDialog()" *ngIf="userService.getUserData()?.username" aria-label="User">
            <mat-icon>perm_identity</mat-icon>
        </button>
        <button mat-fab [matMenuTriggerFor]="loginMenu" *ngIf="!userService.getUserData()?.username" aria-label="User">
            <mat-icon>perm_identity</mat-icon>
        </button>
    </div>
    <div *ngIf="usingCorrection">
        <p>Showing results for <span class="correction" (click)="searchString = suggestion">{{suggestion}}</span></p>
    </div>
    <div id="filters" *ngIf="distinctAuthors.size > 1">
        <mat-form-field>
            <mat-label>Authors</mat-label>
            <mat-select #authorSelect [(ngModel)]="filteredAuthors" (selectionChange)="filterBooks()" multiple>
                <mat-select-trigger>
                    {{filteredAuthors[0] || 'unkown author'}}
                    <span *ngIf="(filteredAuthors?.length || 0) > 1">
                      (+{{(filteredAuthors.length || 0) - 1}})
                    </span>
                  </mat-select-trigger>
                <mat-option class="clear">All</mat-option>
                <mat-option *ngFor="let author of distinctAuthors" [value]="author">{{author || 'unkown author'}}</mat-option>
            </mat-select>
        </mat-form-field>
    </div>
</div>
<div id="search-results">
    <div *ngIf="books?.length == 0" class="nothing-found">
        <h1>No books found matching your search</h1>
        <div class="no-results-buttons">
            <button *ngIf="selectedLang != ''" mat-raised-button color="primary" 
            (click)="resetLangAndSearch()" aria-label="Remove language filter">Remove language filter</button>
        </div>
    </div>
    <app-book *ngFor="let book of books" [book]="book"></app-book>
    <mat-spinner *ngIf="!books || isLoading"></mat-spinner>
</div>
<button mat-mini-fab color="primary" *ngIf="showScrollToTop" (click)="scrollToTop()" aria-label="Scroll to the top">
    <mat-icon>keyboard_arrow_up</mat-icon>
</button>
<mat-menu #loginMenu="matMenu">
    <app-login></app-login>
</mat-menu>